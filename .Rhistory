data = .,
family = binomial(),
weights = perwt)
return(model)
}
less_than_primary_completed_model_mexico <- run_education_model(us_df_2020, "less_than_primary_completed", "mexico")
primary_completed_model_cuba <- run_education_model(us_df_2020, "primary_completed", "cuba")
summary(less_than_primary_completed_model_mexico)
emm_less_than_primary_completed_model_mexico <- emmeans(less_than_primary_completed_model_mexico,
specs = "age_at_immig_groups_string",
at = list(age = 65, female = 1),
type = "response")
emm_less_than_primary_completed_model_mexico <- transform(summary(emm_less_than_primary_completed_model_mexico))
print(emm_less_than_primary_completed_model_mexico)
run_education_model <- function(data, dv, country) {
model <- data %>%
filter(country_string == country) %>%
glm(as.formula(paste(dv, "~ age + as.factor(female) + race_string + age_at_immig_groups_string")),
data = .,
family = binomial(),
weights = perwt)
return(model)
}
less_than_primary_completed_model_mexico <- run_education_model(us_df_2020, "less_than_primary_completed", "mexico")
primary_completed_model_cuba <- run_education_model(us_df_2020, "primary_completed", "cuba")
summary(less_than_primary_completed_model_mexico)
emm_less_than_primary_completed_model_mexico <- emmeans(less_than_primary_completed_model_mexico,
specs = "age_at_immig_groups_string",
at = list(age = 65, female = 1),
type = "response")
emm_less_than_primary_completed_model_mexico <- transform(summary(emm_less_than_primary_completed_model_mexico))
print(emm_less_than_primary_completed_model_mexico)
run_education_model <- function(data, dv, country) {
model <- data %>%
filter(country_string == country) %>%
glm(as.formula(paste(dv, "~ age + as.factor(female) + race_string + married_cohab + age_at_immig_groups_string")),
data = .,
family = binomial(),
weights = perwt)
return(model)
}
less_than_primary_completed_model_mexico <- run_education_model(us_df_2020, "less_than_primary_completed", "mexico")
primary_completed_model_cuba <- run_education_model(us_df_2020, "primary_completed", "cuba")
summary(less_than_primary_completed_model_mexico)
emm_less_than_primary_completed_model_mexico <- emmeans(less_than_primary_completed_model_mexico,
specs = "age_at_immig_groups_string",
at = list(age = 65, female = 1),
type = "response")
emm_less_than_primary_completed_model_mexico <- transform(summary(emm_less_than_primary_completed_model_mexico))
print(emm_less_than_primary_completed_model_mexico)
run_education_model <- function(data, dv, country) {
model <- data %>%
filter(country_string == country) %>%
glm(as.formula(paste(dv, "~ age + as.factor(female) + race_string + married_cohab + year_of_immig_groups_string + age_at_immig_groups_string")),
data = .,
family = binomial(),
weights = perwt)
return(model)
}
less_than_primary_completed_model_mexico <- run_education_model(us_df_2020, "less_than_primary_completed", "mexico")
primary_completed_model_cuba <- run_education_model(us_df_2020, "primary_completed", "cuba")
summary(less_than_primary_completed_model_mexico)
emm_less_than_primary_completed_model_mexico <- emmeans(less_than_primary_completed_model_mexico,
specs = "age_at_immig_groups_string",
at = list(age = 65, female = 1),
type = "response")
emm_less_than_primary_completed_model_mexico <- transform(summary(emm_less_than_primary_completed_model_mexico))
print(emm_less_than_primary_completed_model_mexico)
run_education_model <- function(data, dv, country) {
model <- data %>%
filter(country_string == country) %>%
glm(as.formula(paste(dv, "~ age + as.factor(female) + as.factor(citizen) race_string + married_cohab + year_of_immig_groups_string + age_at_immig_groups_string")),
data = .,
family = binomial(),
weights = perwt)
return(model)
}
less_than_primary_completed_model_mexico <- run_education_model(us_df_2020, "less_than_primary_completed", "mexico")
run_education_model <- function(data, dv, country) {
model <- data %>%
filter(country_string == country) %>%
glm(as.formula(paste(dv, "~ age + as.factor(female) + as.factor(is_naturalized_citizen) race_string + married_cohab + year_of_immig_groups_string + age_at_immig_groups_string")),
data = .,
family = binomial(),
weights = perwt)
return(model)
}
less_than_primary_completed_model_mexico <- run_education_model(us_df_2020, "less_than_primary_completed", "mexico")
run_education_model <- function(data, dv, country) {
model <- data %>%
filter(country_string == country) %>%
glm(as.formula(paste(dv, "~ age + as.factor(female) + as.factor(is_naturalized_citizen) + race_string + married_cohab + year_of_immig_groups_string + age_at_immig_groups_string")),
data = .,
family = binomial(),
weights = perwt)
return(model)
}
less_than_primary_completed_model_mexico <- run_education_model(us_df_2020, "less_than_primary_completed", "mexico")
primary_completed_model_cuba <- run_education_model(us_df_2020, "primary_completed", "cuba")
summary(less_than_primary_completed_model_mexico)
emm_less_than_primary_completed_model_mexico <- emmeans(less_than_primary_completed_model_mexico,
specs = "age_at_immig_groups_string",
at = list(age = 65, female = 1),
type = "response")
emm_less_than_primary_completed_model_mexico <- transform(summary(emm_less_than_primary_completed_model_mexico))
print(emm_less_than_primary_completed_model_mexico)
run_education_model <- function(data, dv, country) {
model <- data %>%
filter(country_string == country) %>%
glm(as.formula(paste(dv, "~ age + as.factor(female) + as.factor(is_naturalized_citizen) + race_string + married_cohab + year_of_immig_groups_string + age_at_immig_groups_string")),
data = .,
family = binomial(),
weights = perwt)
return(model)
}
primary_completed_model_me <- run_education_model(us_df_2020, "primary_or_above", "mexico")
primary_completed_model_cu <- run_education_model(us_df_2020, "primary_or_above", "cuba")
primary_completed_model_pr <- run_education_model(us_df_2020, "primary_or_above", "puerto rico")
primary_completed_model_dr <- run_education_model(us_df_2020, "primary_or_above", "dominican republic")
run_education_model <- function(data, dv, country) {
model <- data %>%
filter(country_string == country) %>%
glm(as.formula(paste(dv, "~ age + as.factor(female) + race_string + married_cohab + year_of_immig_groups_string + age_at_immig_groups_string")),
data = .,
family = binomial(),
weights = perwt)
return(model)
}
primary_completed_model_me <- run_education_model(us_df_2020, "primary_or_above", "mexico")
primary_completed_model_cu <- run_education_model(us_df_2020, "primary_or_above", "cuba")
primary_completed_model_pr <- run_education_model(us_df_2020, "primary_or_above", "puerto rico")
primary_completed_model_dr <- run_education_model(us_df_2020, "primary_or_above", "dominican republic")
summary(primary_completed_model_me)
emm_less_than_primary_completed_model_mexico <- emmeans(primary_completed_model_me,
specs = "age_at_immig_groups_string",
at = list(age = 65, female = 1),
type = "response")
emm_primary_completed_model_me <- transform(summary(emm_primary_completed_model_me))
emm_primary_completed_model_me <- emmeans(primary_completed_model_me,
specs = "age_at_immig_groups_string",
at = list(age = 65, female = 1),
type = "response")
emm_primary_completed_model_me <- transform(summary(emm_primary_completed_model_me))
print(emm_primary_completed_model_me)
run_education_model <- function(data, dv, country) {
model <- data %>%
filter(country_string == country) %>%
glm(as.formula(paste(dv, "~ age + as.factor(female) + race_string + married_cohab + year_of_immig_groups_string + age_at_immig_groups_string")),
data = .,
family = binomial(),
weights = perwt)
return(model)
}
primary_completed_model_me <- run_education_model(us_df_2020, "primary_or_above", "mexico")
primary_completed_model_cu <- run_education_model(us_df_2020, "primary_or_above", "cuba")
primary_completed_model_pr <- run_education_model(us_df_2020, "primary_or_above", "puerto rico")
primary_completed_model_dr <- run_education_model(us_df_2020, "primary_or_above", "dominican republic")
summary(primary_completed_model_me)
emm_primary_completed_model_me <- emmeans(primary_completed_model_me,
specs = "age_at_immig_groups_string",
at = list(age = 65, female = 1),
type = "response")
emm_primary_completed_model_me <- transform(summary(emm_primary_completed_model_me))
print(emm_primary_completed_model_me)
run_education_model <- function(data, dv, country) {
model <- data %>%
filter(country_string == country) %>%
glm(as.formula(paste(dv, "~ age + as.factor(female) + race_string + as.factor(english_speaker) + married_cohab + year_of_immig_groups_string + age_at_immig_groups_string")),
data = .,
family = binomial(),
weights = perwt)
return(model)
}
primary_completed_model_me <- run_education_model(us_df_2020, "primary_or_above", "mexico")
primary_completed_model_cu <- run_education_model(us_df_2020, "primary_or_above", "cuba")
primary_completed_model_pr <- run_education_model(us_df_2020, "primary_or_above", "puerto rico")
primary_completed_model_dr <- run_education_model(us_df_2020, "primary_or_above", "dominican republic")
summary(primary_completed_model_me)
emm_primary_completed_model_me <- emmeans(primary_completed_model_me,
specs = "age_at_immig_groups_string",
at = list(age = 65, female = 1),
type = "response")
emm_primary_completed_model_me <- transform(summary(emm_primary_completed_model_me))
print(emm_primary_completed_model_me)
run_education_model <- function(data, dv, country) {
model <- data %>%
filter(country_string == country) %>%
glm(as.formula(paste(dv, "~ age + as.factor(female) + race_string + as.factor(english_speaker) + married_cohab + year_of_immig_groups_string + age_at_immig_groups_string")),
data = .,
family = binomial(),
weights = perwt)
return(model)
}
primary_completed_model_me <- run_education_model(us_df_2020, "primary_or_above", "mexico")
primary_completed_model_cu <- run_education_model(us_df_2020, "primary_or_above", "cuba")
primary_completed_model_pr <- run_education_model(us_df_2020, "primary_or_above", "puerto rico")
primary_completed_model_dr <- run_education_model(us_df_2020, "primary_or_above", "dominican republic")
summary(primary_completed_model_me)
get_emmeans_summary <- function(model, specs = "age_at_immig_groups_string", age = 65, female = 1, english_speaker = 1, race_string = "white hispanic", year_of_immig_groups_string = "1980 - 1999") {
emm <- emmeans(model,
specs = specs,
at = list(age = age, female = female, english_speaker = english_speaker, race_string = race_string, year_of_immig_groups_string = year_of_immig_groups_string),
type = "response")
emm_summary <- transform(summary(emm))
return(emm_summary)
}
emm_primary_completed_model_me <- get_emmeans_summary(primary_completed_model_me)
print(emm_primary_completed_model_me)
emm_primary_completed_model_me <- get_emmeans_summary(primary_completed_model_cu)
emm_primary_completed_model_me <- get_emmeans_summary(primary_completed_model_pr)
emm_primary_completed_model_me <- get_emmeans_summary(primary_completed_model_dr)
run_education_model <- function(data, dv, country) {
model <- data %>%
filter(country_string == country) %>%
glm(as.formula(paste(dv, "~ age + as.factor(female) + race_string + as.factor(english_speaker) + married_cohab + year_of_immig_groups_string + age_at_immig_groups_string")),
data = .,
family = binomial(),
weights = perwt)
return(model)
}
primary_completed_model_me <- run_education_model(us_df_2020, "primary_or_above", "mexico")
primary_completed_model_cu <- run_education_model(us_df_2020, "primary_or_above", "cuba")
primary_completed_model_pr <- run_education_model(us_df_2020, "primary_or_above", "puerto rico")
primary_completed_model_dr <- run_education_model(us_df_2020, "primary_or_above", "dominican republic")
summary(primary_completed_model_me)
get_emmeans_summary <- function(model, specs = "age_at_immig_groups_string", age = 65, female = 1, english_speaker = 1, race_string = "white hispanic", year_of_immig_groups_string = "1980 - 1999") {
emm <- emmeans(model,
specs = specs,
at = list(age = age, female = female, english_speaker = english_speaker, race_string = race_string, year_of_immig_groups_string = year_of_immig_groups_string),
type = "response")
emm_summary <- transform(summary(emm))
return(emm_summary)
}
emm_primary_completed_model_me <- get_emmeans_summary(primary_completed_model_me) %>%
mutate(country = "mexico")
emm_primary_completed_model_cu <- get_emmeans_summary(primary_completed_model_cu)
emm_primary_completed_model_pr <- get_emmeans_summary(primary_completed_model_pr)
emm_primary_completed_model_dr <- get_emmeans_summary(primary_completed_model_dr)
print(emm_primary_completed_model_me)
run_education_model <- function(data, dv, country) {
model <- data %>%
filter(country_string == country) %>%
glm(as.formula(paste(dv, "~ age + as.factor(female) + race_string + as.factor(english_speaker) + married_cohab + year_of_immig_groups_string + age_at_immig_groups_string")),
data = .,
family = binomial(),
weights = perwt)
return(model)
}
primary_completed_model_me <- run_education_model(us_df_2020, "primary_or_above", "mexico")
primary_completed_model_cu <- run_education_model(us_df_2020, "primary_or_above", "cuba")
primary_completed_model_pr <- run_education_model(us_df_2020, "primary_or_above", "puerto rico")
primary_completed_model_dr <- run_education_model(us_df_2020, "primary_or_above", "dominican republic")
summary(primary_completed_model_me)
get_emmeans_summary <- function(model, specs = "age_at_immig_groups_string", age = 65, female = 1, english_speaker = 1, race_string = "white hispanic", year_of_immig_groups_string = "1980 - 1999") {
emm <- emmeans(model,
specs = specs,
at = list(age = age, female = female, english_speaker = english_speaker, race_string = race_string, year_of_immig_groups_string = year_of_immig_groups_string),
type = "response")
emm_summary <- transform(summary(emm))
return(emm_summary)
}
emm_primary_completed_model_me <- get_emmeans_summary(primary_completed_model_me) %>%
mutate(country = "mexico")
emm_primary_completed_model_cu <- get_emmeans_summary(primary_completed_model_cu) %>%
mutate(country = "cuba")
emm_primary_completed_model_pr <- get_emmeans_summary(primary_completed_model_pr) %>%
mutate(country = "puerto rico")
emm_primary_completed_model_dr <- get_emmeans_summary(primary_completed_model_dr) %>%
mutate(country = "dominican republic")
all_emms_full_controls <- rbind(emm_primary_completed_model_me, emm_primary_completed_model_cu, emm_primary_completed_model_pr, emm_primary_completed_model_dr)
print(all_emms_full_controls)
ggplot(all_emms_full_controls, aes(x = age_at_immig_groups_string, y = prob, color = country, group = country)) +
geom_point(position = position_dodge(width = 0.2)) +
geom_line(position = position_dodge(width = 0.2)) +
geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.1, position = position_dodge(width = 0.2)) +
labs(x = "Age at Immigration", y = "Probability of Primary Education or Above",
title = "Probability of Primary Education or Above by Age at Immigration and Country") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_color_brewer(palette = "Set1")
ggsave(paste0(plot_dir, "predicted_primary_education_by_immigration_age_and_country.png", width = 12, height = 8))
ggsave(paste0(plot_dir, "predicted_primary_education_by_immigration_age_and_country.png"), width = 12, height = 8)
View(us_df_2020)
View(in_df)
table(in_df$edattain_string)
in_df$edattaind
table(in_df$country_string, in_df$edattain_string)
table(in_df$yrschool, in_df$edattain_string)
View(in_df)
View(background_table_code)
View(background_data)
#mexico first
#add lines to differentiate the types of countries
background_data <- read.csv(paste0(data_dir,"hispanic_immigrant_count.csv"))
background_table <- background_data %>%
select(bpld_string, count, percent, GDPpercapita, e60, IMR_1950, IMR_2019) %>%
rename(Country = bpld_string,
`GDP` = GDPpercapita,
`Life Expectancy at 60` = e60,
`Infant Mortality Rate (1950)` = IMR_1950,
`Infant Mortality Rate (2019)` = IMR_2019
)
library(haven)
library(tidyverse)
library(xtable)
library(kableExtra)
library(readxl)
library(officer)
library(broom)
library(writexl)
library(scales)
library(readr)
#mexico first
#add lines to differentiate the types of countries
background_data <- read.csv(paste0(data_dir,"hispanic_immigrant_count.csv"))
background_table <- background_data %>%
select(bpld_string, count, percent, GDPpercapita, e60, IMR_1950, IMR_2019) %>%
rename(Country = bpld_string,
`GDP` = GDPpercapita,
`Life Expectancy at 60` = e60,
`Infant Mortality Rate (1950)` = IMR_1950,
`Infant Mortality Rate (2019)` = IMR_2019
)
print(background_table)
background_table_code <- xtable(background_table,
caption = "Latin American Development Indicators",
align = "ll|cccc")
#mexico first
#add lines to differentiate the types of countries
background_data <- read.csv(paste0(data_dir,"hispanic_immigrant_count.csv"))
background_table <- background_data %>%
select(bpld_string, count, percent, GDPpercapita, e60, IMR_1950, IMR_2019) %>%
rename(Country = bpld_string,
`GDP` = GDPpercapita,
`Life Expectancy at 60` = e60,
`Infant Mortality Rate (1950)` = IMR_1950,
`Infant Mortality Rate (2019)` = IMR_2019
)
print(background_table)
background_table_code <- xtable(background_table,
caption = "Latin American Development Indicators",
align = "ll|cccccc")
latex_code <- capture.output(print(background_table_code,
type = "latex",
caption.placement = "top",
include.rownames = FALSE))
writeLines(latex_code, "/Users/chrissoria/Documents/Research/us_international_ses/tables/r_tables/background_table.tex")
print(latex_code)
rm(background_table)
#mexico first
#add lines to differentiate the types of countries
background_data <- read.csv(paste0(data_dir,"hispanic_immigrant_count.csv"))
background_table <- background_data %>%
select(bpld_string, count, percent, GDPpercapita, e60, IMR_1950, IMR_2019) %>%
rename(Country = bpld_string,
`GDP` = GDPpercapita,
Total = count,
`Percent of Migrants` = percent,
`Life Expectancy at 60` = e60,
`Infant Mortality Rate (1950)` = IMR_1950,
`Infant Mortality Rate (2019)` = IMR_2019
)
print(background_table)
background_table_code <- xtable(background_table,
caption = "Latin American Development Indicators",
align = "ll|cccccc")
latex_code <- capture.output(print(background_table_code,
type = "latex",
caption.placement = "top",
include.rownames = FALSE))
writeLines(latex_code, "/Users/chrissoria/Documents/Research/us_international_ses/tables/r_tables/background_table.tex")
print(latex_code)
rm(background_table)
print(sum(background_data$percent))
#mexico first
#add lines to differentiate the types of countries
background_data <- read.csv(paste0(data_dir,"hispanic_immigrant_count.csv"))
background_table <- background_data %>%
mutate(category = "") %>%
select(category, bpld_string, count, percent, GDPpercapita, e60, IMR_1950, IMR_2019) %>%
rename(Country = bpld_string,
`GDP` = GDPpercapita,
Total = count,
`Percent of Migrants` = percent,
`Life Expectancy at 60` = e60,
`Infant Mortality Rate (1950)` = IMR_1950,
`Infant Mortality Rate (2019)` = IMR_2019
)
print(background_table)
background_table_code <- xtable(background_table,
caption = "Latin American Development Indicators",
align = "ll|cccccc")
#mexico first
#add lines to differentiate the types of countries
background_data <- read.csv(paste0(data_dir,"hispanic_immigrant_count.csv"))
background_table <- background_data %>%
mutate(category = "") %>%
select(category, bpld_string, count, percent, GDPpercapita, e60, IMR_1950, IMR_2019) %>%
rename(Country = bpld_string,
`GDP` = GDPpercapita,
Total = count,
`Percent of Migrants` = percent,
`Life Expectancy at 60` = e60,
`Infant Mortality Rate (1950)` = IMR_1950,
`Infant Mortality Rate (2019)` = IMR_2019
)
print(background_table)
background_table_code <- xtable(background_table,
caption = "Latin American Development Indicators",
align = "lll|cccccc")
latex_code <- capture.output(print(background_table_code,
type = "latex",
caption.placement = "top",
include.rownames = FALSE))
writeLines(latex_code, "/Users/chrissoria/Documents/Research/us_international_ses/tables/r_tables/background_table.tex")
print(latex_code)
rm(background_table)
#mexico first
#add lines to differentiate the types of countries
background_data <- read.csv(paste0(data_dir,"hispanic_immigrant_count.csv"))
background_table <- background_data %>%
mutate(category = "") %>%
select(category, bpld_string, count, percent, GDPpercapita, e60, IMR_1950, IMR_2019) %>%
rename(Country = bpld_string,
`GDP` = GDPpercapita,
Total = count,
`Percent of Migrants` = percent,
`Life Expectancy at 60` = e60,
`Infant Mortality Rate (1950)` = IMR_1950,
`Infant Mortality Rate (2019)` = IMR_2019
) %>%
add_row(category = "Mexico and Carribean Countries", .before = 1)
print(background_table)
background_table_code <- xtable(background_table,
caption = "Latin American Development Indicators",
align = "lll|cccccc")
latex_code <- capture.output(print(background_table_code,
type = "latex",
caption.placement = "top",
include.rownames = FALSE))
writeLines(latex_code, "/Users/chrissoria/Documents/Research/us_international_ses/tables/r_tables/background_table.tex")
print(latex_code)
rm(background_table)
#mexico first
#add lines to differentiate the types of countries
background_data <- read.csv(paste0(data_dir,"hispanic_immigrant_count.csv"))
background_table <- background_data %>%
select(bpld_string, count, percent, GDPpercapita, e60, IMR_1950, IMR_2019) %>%
rename(Country = bpld_string,
`GDP` = GDPpercapita,
Total = count,
`Percent of Migrants` = percent,
`Life Expectancy at 60` = e60,
`Infant Mortality Rate (1950)` = IMR_1950,
`Infant Mortality Rate (2019)` = IMR_2019
) %>%
add_row(Country = "Mexico and Carribean Countries", .before = 1)
print(background_table)
background_table_code <- xtable(background_table,
caption = "Latin American Development Indicators",
align = "lll|cccccc")
#mexico first
#add lines to differentiate the types of countries
background_data <- read.csv(paste0(data_dir,"hispanic_immigrant_count.csv"))
background_table <- background_data %>%
select(bpld_string, count, percent, GDPpercapita, e60, IMR_1950, IMR_2019) %>%
rename(Country = bpld_string,
`GDP` = GDPpercapita,
Total = count,
`Percent of Migrants` = percent,
`Life Expectancy at 60` = e60,
`Infant Mortality Rate (1950)` = IMR_1950,
`Infant Mortality Rate (2019)` = IMR_2019
) %>%
add_row(Country = "Mexico and Carribean Countries", .before = 1)
print(background_table)
background_table_code <- xtable(background_table,
caption = "Latin American Development Indicators",
align = "ll|cccccc")
latex_code <- capture.output(print(background_table_code,
type = "latex",
caption.placement = "top",
include.rownames = FALSE))
writeLines(latex_code, "/Users/chrissoria/Documents/Research/us_international_ses/tables/r_tables/background_table.tex")
print(latex_code)
rm(background_table)
#mexico first
#add lines to differentiate the types of countries
background_data <- read.csv(paste0(data_dir,"hispanic_immigrant_count.csv"))
background_table <- background_data %>%
select(bpld_string, count, percent, GDPpercapita, e60, IMR_1950, IMR_2019) %>%
mutate(percent = percent*100) %>%
rename(Country = bpld_string,
`GDP` = GDPpercapita,
Total = count,
`Percent of Migrants` = percent,
`Life Expectancy at 60` = e60,
`Infant Mortality Rate (1950)` = IMR_1950,
`Infant Mortality Rate (2019)` = IMR_2019
) %>%
add_row(Country = "Mexico and Carribean Countries", .before = 1)
print(background_table)
background_table_code <- xtable(background_table,
caption = "Latin American Development Indicators",
align = "ll|cccccc")
latex_code <- capture.output(print(background_table_code,
type = "latex",
caption.placement = "top",
include.rownames = FALSE))
writeLines(latex_code, "/Users/chrissoria/Documents/Research/us_international_ses/tables/r_tables/background_table.tex")
print(latex_code)
rm(background_table)
