m6 <- tidy(male_country_coefs_2010[[dv]]) %>% mutate(model = "Adjusted (Males Only)")
combined <- bind_rows(m1, m2, m3, m4, m5, m6) %>%
mutate(
term = term_labels[make.names(term)],
stars = case_when(
p.value < 0.01 ~ "***",
p.value < 0.05 ~ "**",
p.value < 0.10 ~ "*",
TRUE ~ ""
),
coef_se = paste0(round(estimate, 3), stars, "\n(", round(std.error, 3), ")")
) %>%
select(term, model, coef_se) %>%
pivot_wider(names_from = model, values_from = coef_se)
# add n and r-squared rows
model_stats <- tibble(
model = c("Unadjusted", "Adjusted", "Unadjusted (Females Only)",
"Adjusted (Females Only)", "Unadjusted (Males Only)", "Adjusted (Males Only)"),
n = c(nobs(results_all_2010[[dv]]), nobs(country_coefs_2010[[dv]]),
nobs(results_female_2010[[dv]]), nobs(female_country_coefs_2010[[dv]]),
nobs(results_male_2010[[dv]]), nobs(male_country_coefs_2010[[dv]])),
r2 = c(glance(results_all_2010[[dv]])$r.squared, glance(country_coefs_2010[[dv]])$r.squared,
glance(results_female_2010[[dv]])$r.squared, glance(female_country_coefs_2010[[dv]])$r.squared,
glance(results_male_2010[[dv]])$r.squared, glance(male_country_coefs_2010[[dv]])$r.squared)
)
n_row <- model_stats %>%
mutate(stat = as.character(n)) %>%
select(model, stat) %>%
pivot_wider(names_from = model, values_from = stat) %>%
mutate(term = "N", .before = 1)
r2_row <- model_stats %>%
mutate(stat = as.character(round(r2, 3))) %>%
select(model, stat) %>%
pivot_wider(names_from = model, values_from = stat) %>%
mutate(term = "R-squared", .before = 1)
combined <- bind_rows(combined, n_row, r2_row)
write_xlsx(combined,
path = paste0(out_dir, "../regressions/", dv, "_models_2010.xlsx"))
}
# renaming mapping for interaction models
term_labels_interaction <- c(
cuba = "Cuba",
`dominican republic` = "Dominican Republic",
`puerto rico` = "Puerto Rico",
mexico = "Mexico",
age_at_immigration_15to24 = "Immigrated Age 15-24",
age_at_immigration_25to49 = "Immigrated Age 25-49",
age_at_immigration_50plus = "Immigrated Age 50+",
yrimm_before1965 = "Immigrated Before 1965",
yrimm_1965to1980 = "Immigrated 1965-1980",
yrimm_1980to1999 = "Immigrated 1980-1999",
female = "Female",
age_70to79 = "Age 70-79",
age_80to89 = "Age 80-89",
age_90plus = "Age 90+",
year2020 = "Year 2020"
)
# function to create interaction model tables
create_interaction_tables <- function(results_list_unadj, results_list_adj,
results_list_female_unadj, results_list_female_adj,
results_list_male_unadj, results_list_male_adj,
dvs, output_prefix) {
for (dv in dvs) {
m1 <- tidy(results_list_unadj[[dv]]) %>% mutate(model = "Unadjusted")
m2 <- tidy(results_list_adj[[dv]]) %>% mutate(model = "Adjusted")
m3 <- tidy(results_list_female_unadj[[dv]]) %>% mutate(model = "Unadjusted (Females Only)")
m4 <- tidy(results_list_female_adj[[dv]]) %>% mutate(model = "Adjusted (Females Only)")
m5 <- tidy(results_list_male_unadj[[dv]]) %>% mutate(model = "Unadjusted (Males Only)")
m6 <- tidy(results_list_male_adj[[dv]]) %>% mutate(model = "Adjusted (Males Only)")
combined <- bind_rows(m1, m2, m3, m4, m5, m6) %>%
mutate(
term = str_remove(term, "country_string"),
term = str_remove(term, ":year2020"),
term = if_else(term == "year2020", "mexico", term),
term = term_labels_interaction[term],
stars = case_when(
p.value < 0.01 ~ "***",
p.value < 0.05 ~ "**",
p.value < 0.10 ~ "*",
TRUE ~ ""
),
coef_se = paste0(round(estimate, 3), stars, "\n(", round(std.error, 3), ")")
) %>%
select(term, model, coef_se) %>%
pivot_wider(names_from = model, values_from = coef_se)
# add n and r-squared rows
model_stats <- tibble(
model = c("Unadjusted", "Adjusted", "Unadjusted (Females Only)",
"Adjusted (Females Only)", "Unadjusted (Males Only)", "Adjusted (Males Only)"),
n = c(nobs(results_list_unadj[[dv]]), nobs(results_list_adj[[dv]]),
nobs(results_list_female_unadj[[dv]]), nobs(results_list_female_adj[[dv]]),
nobs(results_list_male_unadj[[dv]]), nobs(results_list_male_adj[[dv]])),
r2 = c(glance(results_list_unadj[[dv]])$r.squared, glance(results_list_adj[[dv]])$r.squared,
glance(results_list_female_unadj[[dv]])$r.squared, glance(results_list_female_adj[[dv]])$r.squared,
glance(results_list_male_unadj[[dv]])$r.squared, glance(results_list_male_adj[[dv]])$r.squared)
)
n_row <- model_stats %>%
mutate(stat = as.character(n)) %>%
select(model, stat) %>%
pivot_wider(names_from = model, values_from = stat) %>%
mutate(term = "N", .before = 1)
r2_row <- model_stats %>%
mutate(stat = as.character(round(r2, 3))) %>%
select(model, stat) %>%
pivot_wider(names_from = model, values_from = stat) %>%
mutate(term = "R-squared", .before = 1)
combined <- bind_rows(combined, n_row, r2_row)
write_xlsx(combined,
path = paste0(out_dir, "../regressions/", output_prefix, "_", dv, "_interaction.xlsx"))
}
}
# need to modify the create_country_coefs function to return the full results_list
create_country_coefs_full <- function(data, sex_filter = NULL, include_controls = FALSE) {
if (!is.null(sex_filter)) {
data <- data %>% filter(sex == sex_filter)
}
dvs <- c("married_cohab", "lives_alone", "english_speaker", "secondary_or_above",
"is_naturalized_citizen", "less_than_primary_completed")
ivs <- if (include_controls) {
c("country_string*year", "age_at_immigration_15to24","age_at_immigration_25to49",
"age_at_immigration_50plus", "yrimm_before1965", "yrimm_1965to1980",
"yrimm_1980to1999", "female", "age_70to79", "age_80to89", "age_90plus")
} else {
c("country_string*year")
}
results_list <- list()
for (dv in dvs) {
current_countries <- if (dv == "is_naturalized_citizen") {
c("mexico", "dominican republic", "cuba")
} else {
c("mexico", "puerto rico", "dominican republic", "cuba")
}
current_ivs <- if (dv == "less_than_primary_completed") {
ivs[!ivs %in% "secondary_or_above"]
} else {
ivs
}
data_filtered <- data %>%
filter(country_string %in% current_countries) %>%
mutate(country_string = fct_relevel(country_string, "mexico"))
formula <- as.formula(paste(dv, "~", paste(current_ivs, collapse = " + ")))
model <- lm(formula, data = data_filtered, weights = perwt)
results_list[[dv]] <- model
}
return(results_list)
}
# create model lists
results_interaction_unadj <- create_country_coefs_full(us_df_all, include_controls = FALSE)
results_interaction_adj <- create_country_coefs_full(us_df_all, include_controls = TRUE)
results_female_interaction_unadj <- create_country_coefs_full(us_df_all, sex_filter = 2, include_controls = FALSE)
results_female_interaction_adj <- create_country_coefs_full(us_df_all, sex_filter = 2, include_controls = TRUE)
results_male_interaction_unadj <- create_country_coefs_full(us_df_all, sex_filter = 1, include_controls = FALSE)
results_male_interaction_adj <- create_country_coefs_full(us_df_all, sex_filter = 1, include_controls = TRUE)
# generate tables
dvs <- c("married_cohab", "lives_alone", "english_speaker", "secondary_or_above",
"is_naturalized_citizen", "less_than_primary_completed")
create_interaction_tables(
results_interaction_unadj, results_interaction_adj,
results_female_interaction_unadj, results_female_interaction_adj,
results_male_interaction_unadj, results_male_interaction_adj,
dvs, "interaction_models"
)
# function to create interaction model tables
create_interaction_tables <- function(results_list_unadj, results_list_adj,
results_list_female_unadj, results_list_female_adj,
results_list_male_unadj, results_list_male_adj,
dvs, output_prefix) {
for (dv in dvs) {
m1 <- tidy(results_list_unadj[[dv]]) %>% mutate(model = "Unadjusted")
m2 <- tidy(results_list_adj[[dv]]) %>% mutate(model = "Adjusted")
m3 <- tidy(results_list_female_unadj[[dv]]) %>% mutate(model = "Unadjusted (Females Only)")
m4 <- tidy(results_list_female_adj[[dv]]) %>% mutate(model = "Adjusted (Females Only)")
m5 <- tidy(results_list_male_unadj[[dv]]) %>% mutate(model = "Unadjusted (Males Only)")
m6 <- tidy(results_list_male_adj[[dv]]) %>% mutate(model = "Adjusted (Males Only)")
combined <- bind_rows(m1, m2, m3, m4, m5, m6) %>%
filter(term != "(Intercept)") %>%
mutate(
term = str_remove(term, "country_string"),
term = str_remove(term, ":year2020"),
term = if_else(term == "year2020", "mexico", term)
) %>%
mutate(
term = term_labels_interaction[term],
stars = case_when(
p.value < 0.01 ~ "***",
p.value < 0.05 ~ "**",
p.value < 0.10 ~ "*",
TRUE ~ ""
),
coef_se = paste0(round(estimate, 3), stars, "\n(", round(std.error, 3), ")")
) %>%
select(term, model, coef_se) %>%
filter(!is.na(term)) %>%
pivot_wider(names_from = model, values_from = coef_se)
# add n and r-squared rows
model_stats <- tibble(
model = c("Unadjusted", "Adjusted", "Unadjusted (Females Only)",
"Adjusted (Females Only)", "Unadjusted (Males Only)", "Adjusted (Males Only)"),
n = c(nobs(results_list_unadj[[dv]]), nobs(results_list_adj[[dv]]),
nobs(results_list_female_unadj[[dv]]), nobs(results_list_female_adj[[dv]]),
nobs(results_list_male_unadj[[dv]]), nobs(results_list_male_adj[[dv]])),
r2 = c(glance(results_list_unadj[[dv]])$r.squared, glance(results_list_adj[[dv]])$r.squared,
glance(results_list_female_unadj[[dv]])$r.squared, glance(results_list_female_adj[[dv]])$r.squared,
glance(results_list_male_unadj[[dv]])$r.squared, glance(results_list_male_adj[[dv]])$r.squared)
)
n_row <- model_stats %>%
mutate(stat = as.character(n)) %>%
select(model, stat) %>%
pivot_wider(names_from = model, values_from = stat) %>%
mutate(term = "N", .before = 1)
r2_row <- model_stats %>%
mutate(stat = as.character(round(r2, 3))) %>%
select(model, stat) %>%
pivot_wider(names_from = model, values_from = stat) %>%
mutate(term = "R-squared", .before = 1)
combined <- bind_rows(combined, n_row, r2_row)
write_xlsx(combined,
path = paste0(out_dir, "../regressions/", output_prefix, "_", dv, "_interaction.xlsx"))
}
}
# function to create interaction model tables
create_interaction_tables <- function(results_list_unadj, results_list_adj,
results_list_female_unadj, results_list_female_adj,
results_list_male_unadj, results_list_male_adj,
dvs, output_prefix) {
for (dv in dvs) {
m1 <- tidy(results_list_unadj[[dv]]) %>% mutate(model = "Unadjusted")
m2 <- tidy(results_list_adj[[dv]]) %>% mutate(model = "Adjusted")
m3 <- tidy(results_list_female_unadj[[dv]]) %>% mutate(model = "Unadjusted (Females Only)")
m4 <- tidy(results_list_female_adj[[dv]]) %>% mutate(model = "Adjusted (Females Only)")
m5 <- tidy(results_list_male_unadj[[dv]]) %>% mutate(model = "Unadjusted (Males Only)")
m6 <- tidy(results_list_male_adj[[dv]]) %>% mutate(model = "Adjusted (Males Only)")
combined <- bind_rows(m1, m2, m3, m4, m5, m6) %>%
filter(term != "(Intercept)") %>%
mutate(
term = str_remove(term, "country_string"),
term = str_remove(term, ":year2020"),
term = if_else(term == "year2020", "mexico", term)
) %>%
mutate(
term = term_labels_interaction[term],
stars = case_when(
p.value < 0.01 ~ "***",
p.value < 0.05 ~ "**",
p.value < 0.10 ~ "*",
TRUE ~ ""
),
coef_se = paste0(round(estimate, 3), stars, "\n(", round(std.error, 3), ")")
) %>%
select(term, model, coef_se) %>%
filter(!is.na(term)) %>%
pivot_wider(names_from = model, values_from = coef_se)
# add n and r-squared rows
model_stats <- tibble(
model = c("Unadjusted", "Adjusted", "Unadjusted (Females Only)",
"Adjusted (Females Only)", "Unadjusted (Males Only)", "Adjusted (Males Only)"),
n = c(nobs(results_list_unadj[[dv]]), nobs(results_list_adj[[dv]]),
nobs(results_list_female_unadj[[dv]]), nobs(results_list_female_adj[[dv]]),
nobs(results_list_male_unadj[[dv]]), nobs(results_list_male_adj[[dv]])),
r2 = c(glance(results_list_unadj[[dv]])$r.squared, glance(results_list_adj[[dv]])$r.squared,
glance(results_list_female_unadj[[dv]])$r.squared, glance(results_list_female_adj[[dv]])$r.squared,
glance(results_list_male_unadj[[dv]])$r.squared, glance(results_list_male_adj[[dv]])$r.squared)
)
n_row <- model_stats %>%
mutate(stat = as.character(n)) %>%
select(model, stat) %>%
pivot_wider(names_from = model, values_from = stat) %>%
mutate(term = "N", .before = 1)
r2_row <- model_stats %>%
mutate(stat = as.character(round(r2, 3))) %>%
select(model, stat) %>%
pivot_wider(names_from = model, values_from = stat) %>%
mutate(term = "R-squared", .before = 1)
combined <- bind_rows(combined, n_row, r2_row)
write_xlsx(combined,
path = paste0(out_dir, "../regressions/", output_prefix, "_", dv, "_interaction.xlsx"))
}
}
# function to create interaction model tables
create_interaction_tables <- function(results_list_unadj, results_list_adj,
results_list_female_unadj, results_list_female_adj,
results_list_male_unadj, results_list_male_adj,
dvs, output_prefix) {
for (dv in dvs) {
m1 <- tidy(results_list_unadj[[dv]]) %>% mutate(model = "Unadjusted")
m2 <- tidy(results_list_adj[[dv]]) %>% mutate(model = "Adjusted")
m3 <- tidy(results_list_female_unadj[[dv]]) %>% mutate(model = "Unadjusted (Females Only)")
m4 <- tidy(results_list_female_adj[[dv]]) %>% mutate(model = "Adjusted (Females Only)")
m5 <- tidy(results_list_male_unadj[[dv]]) %>% mutate(model = "Unadjusted (Males Only)")
m6 <- tidy(results_list_male_adj[[dv]]) %>% mutate(model = "Adjusted (Males Only)")
combined <- bind_rows(m1, m2, m3, m4, m5, m6) %>%
filter(term != "(Intercept)") %>%
mutate(
term = str_remove(term, "country_string"),
term = str_remove(term, ":year2020"),
term = if_else(term == "year2020", "mexico", term)
) %>%
mutate(
term = term_labels_interaction[term],
stars = case_when(
p.value < 0.01 ~ "***",
p.value < 0.05 ~ "**",
p.value < 0.10 ~ "*",
TRUE ~ ""
),
coef_se = paste0(round(estimate, 3), stars, "\n(", round(std.error, 3), ")")
) %>%
select(term, model, coef_se) %>%
filter(!is.na(term)) %>%
pivot_wider(names_from = model, values_from = coef_se)
# add n and r-squared rows
model_stats <- tibble(
model = c("Unadjusted", "Adjusted", "Unadjusted (Females Only)",
"Adjusted (Females Only)", "Unadjusted (Males Only)", "Adjusted (Males Only)"),
n = c(nobs(results_list_unadj[[dv]]), nobs(results_list_adj[[dv]]),
nobs(results_list_female_unadj[[dv]]), nobs(results_list_female_adj[[dv]]),
nobs(results_list_male_unadj[[dv]]), nobs(results_list_male_adj[[dv]])),
r2 = c(glance(results_list_unadj[[dv]])$r.squared, glance(results_list_adj[[dv]])$r.squared,
glance(results_list_female_unadj[[dv]])$r.squared, glance(results_list_female_adj[[dv]])$r.squared,
glance(results_list_male_unadj[[dv]])$r.squared, glance(results_list_male_adj[[dv]])$r.squared)
)
n_row <- model_stats %>%
mutate(stat = as.character(n)) %>%
select(model, stat) %>%
pivot_wider(names_from = model, values_from = stat) %>%
mutate(term = "N", .before = 1)
r2_row <- model_stats %>%
mutate(stat = as.character(round(r2, 3))) %>%
select(model, stat) %>%
pivot_wider(names_from = model, values_from = stat) %>%
mutate(term = "R-squared", .before = 1)
combined <- bind_rows(combined, n_row, r2_row)
write_xlsx(combined,
path = paste0(out_dir, "../regressions/", output_prefix, "_", dv, "_interaction.xlsx"))
}
}
# first create the model lists using the helper function
results_interaction_unadj <- create_country_coefs_full(us_df_all, include_controls = FALSE)
results_interaction_adj <- create_country_coefs_full(us_df_all, include_controls = TRUE)
results_female_interaction_unadj <- create_country_coefs_full(us_df_all, sex_filter = 2, include_controls = FALSE)
results_female_interaction_adj <- create_country_coefs_full(us_df_all, sex_filter = 2, include_controls = TRUE)
results_male_interaction_unadj <- create_country_coefs_full(us_df_all, sex_filter = 1, include_controls = FALSE)
results_male_interaction_adj <- create_country_coefs_full(us_df_all, sex_filter = 1, include_controls = TRUE)
# then call the function to generate tables
dvs <- c("married_cohab", "lives_alone", "english_speaker", "secondary_or_above",
"is_naturalized_citizen", "less_than_primary_completed")
create_interaction_tables(
results_interaction_unadj,
results_interaction_adj,
results_female_interaction_unadj,
results_female_interaction_adj,
results_male_interaction_unadj,
results_male_interaction_adj,
dvs,
"interaction_models"
)
# function to create interaction model tables
create_interaction_tables <- function(results_list_unadj, results_list_adj,
results_list_female_unadj, results_list_female_adj,
results_list_male_unadj, results_list_male_adj,
dvs, output_prefix) {
for (dv in dvs) {
m1 <- tidy(results_list_unadj[[dv]]) %>% mutate(model = "Unadjusted")
m2 <- tidy(results_list_adj[[dv]]) %>% mutate(model = "Adjusted")
m3 <- tidy(results_list_female_unadj[[dv]]) %>% mutate(model = "Unadjusted (Females Only)")
m4 <- tidy(results_list_female_adj[[dv]]) %>% mutate(model = "Adjusted (Females Only)")
m5 <- tidy(results_list_male_unadj[[dv]]) %>% mutate(model = "Unadjusted (Males Only)")
m6 <- tidy(results_list_male_adj[[dv]]) %>% mutate(model = "Adjusted (Males Only)")
combined <- bind_rows(m1, m2, m3, m4, m5, m6) %>%
filter(term != "(Intercept)") %>%
mutate(
term = str_remove(term, "country_string"),
term = str_remove(term, ":year2020"),
term = if_else(term == "year2020", "mexico", term)
) %>%
mutate(
term = term_labels_interaction[term],
stars = case_when(
p.value < 0.01 ~ "***",
p.value < 0.05 ~ "**",
p.value < 0.10 ~ "*",
TRUE ~ ""
),
coef_se = paste0(round(estimate, 3), stars, "\n(", round(std.error, 3), ")")
) %>%
select(term, model, coef_se) %>%
filter(!is.na(term)) %>%
distinct(term, model, .keep_all = TRUE) %>%
pivot_wider(names_from = model, values_from = coef_se)
# add n and r-squared rows
model_stats <- tibble(
model = c("Unadjusted", "Adjusted", "Unadjusted (Females Only)",
"Adjusted (Females Only)", "Unadjusted (Males Only)", "Adjusted (Males Only)"),
n = c(nobs(results_list_unadj[[dv]]), nobs(results_list_adj[[dv]]),
nobs(results_list_female_unadj[[dv]]), nobs(results_list_female_adj[[dv]]),
nobs(results_list_male_unadj[[dv]]), nobs(results_list_male_adj[[dv]])),
r2 = c(glance(results_list_unadj[[dv]])$r.squared, glance(results_list_adj[[dv]])$r.squared,
glance(results_list_female_unadj[[dv]])$r.squared, glance(results_list_female_adj[[dv]])$r.squared,
glance(results_list_male_unadj[[dv]])$r.squared, glance(results_list_male_adj[[dv]])$r.squared)
)
n_row <- model_stats %>%
mutate(stat = as.character(n)) %>%
select(model, stat) %>%
pivot_wider(names_from = model, values_from = stat) %>%
mutate(term = "N", .before = 1)
r2_row <- model_stats %>%
mutate(stat = as.character(round(r2, 3))) %>%
select(model, stat) %>%
pivot_wider(names_from = model, values_from = stat) %>%
mutate(term = "R-squared", .before = 1)
combined <- bind_rows(combined, n_row, r2_row)
write_xlsx(combined,
path = paste0(out_dir, "../regressions/", output_prefix, "_", dv, "_interaction.xlsx"))
}
}
# first create the model lists using the helper function
results_interaction_unadj <- create_country_coefs_full(us_df_all, include_controls = FALSE)
results_interaction_adj <- create_country_coefs_full(us_df_all, include_controls = TRUE)
results_female_interaction_unadj <- create_country_coefs_full(us_df_all, sex_filter = 2, include_controls = FALSE)
results_female_interaction_adj <- create_country_coefs_full(us_df_all, sex_filter = 2, include_controls = TRUE)
results_male_interaction_unadj <- create_country_coefs_full(us_df_all, sex_filter = 1, include_controls = FALSE)
results_male_interaction_adj <- create_country_coefs_full(us_df_all, sex_filter = 1, include_controls = TRUE)
# then call the function to generate tables
dvs <- c("married_cohab", "lives_alone", "english_speaker", "secondary_or_above",
"is_naturalized_citizen", "less_than_primary_completed")
create_interaction_tables(
results_interaction_unadj,
results_interaction_adj,
results_female_interaction_unadj,
results_female_interaction_adj,
results_male_interaction_unadj,
results_male_interaction_adj,
dvs,
"interaction_models"
)
# function to create interaction model tables
create_interaction_tables <- function(results_list_unadj, results_list_adj,
results_list_female_unadj, results_list_female_adj,
results_list_male_unadj, results_list_male_adj,
dvs, output_prefix) {
for (dv in dvs) {
m1 <- tidy(results_list_unadj[[dv]]) %>% mutate(model = "Unadjusted")
m2 <- tidy(results_list_adj[[dv]]) %>% mutate(model = "Adjusted")
m3 <- tidy(results_list_female_unadj[[dv]]) %>% mutate(model = "Unadjusted (Females Only)")
m4 <- tidy(results_list_female_adj[[dv]]) %>% mutate(model = "Adjusted (Females Only)")
m5 <- tidy(results_list_male_unadj[[dv]]) %>% mutate(model = "Unadjusted (Males Only)")
m6 <- tidy(results_list_male_adj[[dv]]) %>% mutate(model = "Adjusted (Males Only)")
combined <- bind_rows(m1, m2, m3, m4, m5, m6) %>%
filter(str_detect(term, ":year2020")) %>%
mutate(
term = str_remove(term, "country_string"),
term = str_remove(term, ":year2020")
) %>%
mutate(
term = term_labels_interaction[term],
stars = case_when(
p.value < 0.01 ~ "***",
p.value < 0.05 ~ "**",
p.value < 0.10 ~ "*",
TRUE ~ ""
),
coef_se = paste0(round(estimate, 3), stars, "\n(", round(std.error, 3), ")")
) %>%
select(term, model, coef_se) %>%
filter(!is.na(term)) %>%
pivot_wider(names_from = model, values_from = coef_se)
# add n and r-squared rows
model_stats <- tibble(
model = c("Unadjusted", "Adjusted", "Unadjusted (Females Only)",
"Adjusted (Females Only)", "Unadjusted (Males Only)", "Adjusted (Males Only)"),
n = c(nobs(results_list_unadj[[dv]]), nobs(results_list_adj[[dv]]),
nobs(results_list_female_unadj[[dv]]), nobs(results_list_female_adj[[dv]]),
nobs(results_list_male_unadj[[dv]]), nobs(results_list_male_adj[[dv]])),
r2 = c(glance(results_list_unadj[[dv]])$r.squared, glance(results_list_adj[[dv]])$r.squared,
glance(results_list_female_unadj[[dv]])$r.squared, glance(results_list_female_adj[[dv]])$r.squared,
glance(results_list_male_unadj[[dv]])$r.squared, glance(results_list_male_adj[[dv]])$r.squared)
)
n_row <- model_stats %>%
mutate(stat = as.character(n)) %>%
select(model, stat) %>%
pivot_wider(names_from = model, values_from = stat) %>%
mutate(term = "N", .before = 1)
r2_row <- model_stats %>%
mutate(stat = as.character(round(r2, 3))) %>%
select(model, stat) %>%
pivot_wider(names_from = model, values_from = stat) %>%
mutate(term = "R-squared", .before = 1)
combined <- bind_rows(combined, n_row, r2_row)
write_xlsx(combined,
path = paste0(out_dir, "../regressions/", output_prefix, "_", dv, "_interaction.xlsx"))
}
}
# first create the model lists using the helper function
results_interaction_unadj <- create_country_coefs_full(us_df_all, include_controls = FALSE)
results_interaction_adj <- create_country_coefs_full(us_df_all, include_controls = TRUE)
results_female_interaction_unadj <- create_country_coefs_full(us_df_all, sex_filter = 2, include_controls = FALSE)
results_female_interaction_adj <- create_country_coefs_full(us_df_all, sex_filter = 2, include_controls = TRUE)
results_male_interaction_unadj <- create_country_coefs_full(us_df_all, sex_filter = 1, include_controls = FALSE)
results_male_interaction_adj <- create_country_coefs_full(us_df_all, sex_filter = 1, include_controls = TRUE)
# then call the function to generate tables
dvs <- c("married_cohab", "lives_alone", "english_speaker", "secondary_or_above",
"is_naturalized_citizen", "less_than_primary_completed")
create_interaction_tables(
results_interaction_unadj,
results_interaction_adj,
results_female_interaction_unadj,
results_female_interaction_adj,
results_male_interaction_unadj,
results_male_interaction_adj,
dvs,
"interaction_models"
)
